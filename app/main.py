from fastapi import FastAPI, Request
import requests
import logging
import hashlib
import time
import threading
import random
from typing import Dict

app = FastAPI()
BOT_TOKEN = "8489104550:AAFBM9lAuYjojh2DpYTOhFj5Jo-SowOJfXQ"
logger = logging.getLogger(__name__)

# –ö—ç—à –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
response_cache = {}
user_context = {}  # –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

# üîß –ê–í–¢–û-–ü–ò–ù–ì–ï–† –î–õ–Ø RENDER
def keep_alive():
    while True:
        try:
            requests.get("https://new-era-ai-bot.onrender.com", timeout=10)
            logger.info("üîÑ –°–µ—Ä–≤–µ—Ä —Ä–∞–∑–±—É–∂–µ–Ω!")
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø–∏–Ω–≥–∞: {e}")
        time.sleep(600)

ping_thread = threading.Thread(target=keep_alive, daemon=True)
ping_thread.start()

class SmartDeepSeekAI:
    # –£–ú–ù–´–ï –û–¢–í–ï–¢–´ –ù–ê –ö–û–ù–ö–†–ï–¢–ù–´–ï –í–û–ü–†–û–°–´
    SMART_RESPONSES = {
        "—Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –ª–µ—Ç": "ü§ñ –Ø SuperAi+ - –º–æ–π –∫–æ–¥ –±—ã–ª —Å–æ–∑–¥–∞–Ω –Ω–µ–¥–∞–≤–Ω–æ, –Ω–æ –º–æ–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—É—á–∞—é—Ç—Å—è —Å –∫–∞–∂–¥–æ–π —Å–µ–∫—É–Ω–¥–æ–π! –ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —è –≤ —Ä–∞—Å—Ü–≤–µ—Ç–µ —Å–∏–ª! üöÄ",
        
        "–∫—Ç–æ —Ç–µ–±—è —Å–æ–∑–¥–∞–ª": "üíé –ú–µ–Ω—è —Å–æ–∑–¥–∞–ª–∞ –∫–æ–º–∞–Ω–¥–∞ —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–æ–≤ AI-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏! –ê —Å–µ–π—á–∞—Å –º–Ω–æ–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å DeepSeek.",
        
        "—Å—Ç–æ–π": "üõë –û—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è! –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å? –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å!",
        
        "–ø–æ–º–æ–≥–∏ —Å–¥–µ–ª–∞—Ç—å –¥–∑": "üéØ **–ü–æ–º–æ—â—å —Å –¥–æ–º–∞—à–Ω–∏–º –∑–∞–¥–∞–Ω–∏–µ–º:**\n\n1. üìö **–£—Ç–æ—á–Ω–∏ –ø—Ä–µ–¥–º–µ—Ç** (–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ñ–∏–∑–∏–∫–∞, —è–∑—ã–∫–∏?)\n2. üéØ **–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞** (–ø—Ä–∏–º–µ—Ä, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ, —Ç–µ–º–∞)\n3. üí° **–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** (—à–∫–æ–ª–∞, —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç?)\n\n–û–ø–∏—à–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ - –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è!",
        
        "–ø—Ä–∏–≤–µ—Ç": "üöÄ –ü—Ä–∏–≤–µ—Ç! –Ø SuperAi+ - —Ç–≤–æ–π —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫! –ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã, —Å—Ç–∞–≤—å –∑–∞–¥–∞—á–∏, —è –ø–æ–º–æ–≥—É!",
        
        "–∫–∞–∫ –¥–µ–ª–∞": "üíé –û—Ç–ª–∏—á–Ω–æ! –†–∞–±–æ—Ç–∞—é –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ 24/7! –ê —É —Ç–µ–±—è –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?",
        
        "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å": "üîÆ **–ú–æ–∏ —Å—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**\n‚Ä¢ –†–µ—à–∞—é –∑–∞–¥–∞—á–∏ –∏ –ø–æ–º–æ–≥–∞—é —Å —É—á–µ–±–æ–π\n‚Ä¢ –î–µ–∫–æ–º–ø–æ–∑–∏—Ä—É—é —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ª–∏\n‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é\n‚Ä¢ –†–∞–±–æ—Ç–∞—é —Å –≥–æ–ª–æ—Å–æ–º –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏\n‚Ä¢ –ü–æ–Ω–∏–º–∞—é –∫–æ–Ω—Ç–µ–∫—Å—Ç –±–µ—Å–µ–¥—ã",
    }

    @staticmethod
    def get_smart_response(user_message: str, chat_id: int) -> str:
        user_lower = user_message.lower().strip()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —É–º–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
        for question, answer in SmartDeepSeekAI.SMART_RESPONSES.items():
            if question in user_lower:
                return answer
        
        # –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞
        if any(word in user_lower for word in ['–ø–æ–º–æ–≥–∏', '–ø–æ–º–æ—â—å', '—Å–¥–µ–ª–∞–π', '—Ä–µ—à–∏']):
            return SmartDeepSeekAI.help_with_task(user_message)
        
        elif any(word in user_lower for word in ['—Å–∫–æ–ª—å–∫–æ', '–∫–æ–≥–¥–∞', '–≥–¥–µ', '–ø–æ—á–µ–º—É']):
            return SmartDeepSeekAI.answer_question(user_message)
        
        elif any(word in user_lower for word in ['–∑–∞–¥–∞—á–∞', '–ø–ª–∞–Ω', '–ø—Ä–æ–µ–∫—Ç']):
            return SmartDeepSeekAI.create_plan(user_message)
        
        else:
            return SmartDeepSeekAI.general_response(user_message)

    @staticmethod
    def help_with_task(task: str) -> str:
        tasks = {
            '–¥–∑': f"üìö **–ü–æ–º–æ—â—å —Å –¥–æ–º–∞—à–Ω–∏–º –∑–∞–¥–∞–Ω–∏–µ–º:**\n\n–ü–æ –∫–∞–∫–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É –Ω—É–∂–Ω–æ –ø–æ–º–æ—á—å? –£—Ç–æ—á–Ω–∏:\n‚Ä¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞\n‚Ä¢ –§–∏–∑–∏–∫–∞\n‚Ä¢ –Ø–∑—ã–∫–∏\n‚Ä¢ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ\n‚Ä¢ –î—Ä—É–≥–æ–µ\n\n–û–ø–∏—à–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É!",
            '–ø—Ä–æ–µ–∫—Ç': f"üéØ **–ü–æ–º–æ—â—å —Å –ø—Ä–æ–µ–∫—Ç–æ–º:**\n\n1. üìù **–û–ø–∏—à–∏ —Ç–µ–º—É –ø—Ä–æ–µ–∫—Ç–∞**\n2. üéØ **–ö–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω—É–∂–µ–Ω?**\n3. ‚è∞ **–°—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**\n4. üõ†Ô∏è **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**\n\n–î–∞–≤–∞–π –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å!",
            '–∫–æ–¥': f"üíª **–ü–æ–º–æ—â—å —Å –∫–æ–¥–æ–º:**\n\n1. üêç **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è**\n2. üéØ **–ß—Ç–æ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å –∫–æ–¥?**\n3. üö® **–ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç?**\n4. üìÅ **–ú–æ–∂–µ—à—å –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–¥?**\n\n–ü–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è!",
        }
        
        for key, response in tasks.items():
            if key in task.lower():
                return response
        
        return f"üéØ **–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –∑–∞–¥–∞—á–µ–π!**\n\n**–ó–∞–¥–∞—á–∞:** {task}\n\nüí° **–ß—Ç–æ –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å:**\n1. –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ü–µ–ª—å\n2. –ü—Ä–µ–¥–º–µ—Ç/–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\n3. –°—Ä–æ–∫–∏\n4. –¢–µ–∫—É—â–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏\n\n–û–ø–∏—à–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ - —Å–æ—Å—Ç–∞–≤–ª—é –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π!"

    @staticmethod
    def answer_question(question: str) -> str:
        answers = [
            f"ü§î **–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å!**\n\n_{question}_\n\nüí° –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –≤–º–µ—Å—Ç–µ! –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ —ç—Ç–æ–º –≤–æ–ø—Ä–æ—Å–µ?",
            f"üéØ **–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞!**\n\n**–í–æ–ø—Ä–æ—Å:** {question}\n\nüîç **–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**\n‚Ä¢ [–ø–µ—Ä–≤—ã–π –∞—Å–ø–µ–∫—Ç]\n‚Ä¢ [–≤—Ç–æ—Ä–æ–π –∞—Å–ø–µ–∫—Ç]\n‚Ä¢ [—Ç—Ä–µ—Ç–∏–π –∞—Å–ø–µ–∫—Ç]\n\nüíé –ù—É–∂–Ω–∞ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∞—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞?",
            f"üß† **–ì–ª—É–±–æ–∫–∏–π –≤–æ–ø—Ä–æ—Å!**\n\n_{question}_\n\nüìö **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —É—Ç–æ—á–Ω–∏—Ç–µ:**\n‚Ä¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞\n‚Ä¢ –í–∞—à —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞–Ω–∏–π\n‚Ä¢ –¶–µ–ª—å –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏\n\n‚ö° –ë—ã—Å—Ç—Ä–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é –æ—Ç–≤–µ—Ç –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã!"
        ]
        return random.choice(answers)

    @staticmethod
    def create_plan(task: str) -> str:
        plans = [
            f"üìã **–ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**\n\n**–ó–∞–¥–∞—á–∞:** {task}\n\n‚úÖ **–®–∞–≥ 1:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª—å –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞\n‚úÖ **–®–∞–≥ 2:** –†–∞–∑–±–∏—Ç—å –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏\n‚úÖ **–®–∞–≥ 3:** –†–∞—Å—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã\n‚úÖ **–®–∞–≥ 4:** –í—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É\n‚úÖ **–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç\n\nüöÄ _–ì–æ—Ç–æ–≤ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π —à–∞–≥!_",
            f"üéØ **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**\n\n**–¶–µ–ª—å:** {task}\n\nüîπ **–≠—Ç–∞–ø 1:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑\nüîπ **–≠—Ç–∞–ø 2:** –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è\nüîπ **–≠—Ç–∞–ø 3:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–ª—É—á—à–µ–Ω–∏—è\nüîπ **–≠—Ç–∞–ø 4:** –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞\n\nüí° _–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —ç—Ç–∞–ø–æ–º?_"
        ]
        return random.choice(plans)

    @staticmethod
    def general_response(message: str) -> str:
        responses = [
            f"üîÆ **SuperAi+ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç...**\n\n**–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:** {message}\n\nüíé **–ú–æ–π –∞–Ω–∞–ª–∏–∑:** [–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç]\nüéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** [–ø–æ–ª–µ–∑–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ]\n\n‚ö° _–£—Ç–æ—á–Ω–∏—Ç–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ!_",
            f"üöÄ **–ü–æ–Ω–∏–º–∞—é –≤–∞—à –∑–∞–ø—Ä–æ—Å!**\n\n_{message}_\n\nüí° **–ú–æ–≥—É –ø–æ–º–æ—á—å —Å:**\n‚Ä¢ –†–µ—à–µ–Ω–∏–µ–º –∑–∞–¥–∞—á\n‚Ä¢ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º\n‚Ä¢ –ê–Ω–∞–ª–∏–∑–æ–º –∏–¥–µ–π\n‚Ä¢ –û–±—É—á–µ–Ω–∏–µ–º\n\nüéØ –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
            f"üíé **–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ!**\n\n**–ó–∞–ø—Ä–æ—Å:** {message}\n\nüß† **–ú–æ–∏ –º—ã—Å–ª–∏:** [–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç]\n‚ö° **–î–µ–π—Å—Ç–≤–∏–µ:** [–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞]\n\nüîÆ _–ì–æ—Ç–æ–≤ —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ —Ç–µ–º—É!_"
        ]
        return random.choice(responses)

@app.post("/webhook")
async def handle_webhook(request: Request):
    try:
        update = await request.json()
        
        if "message" in update:
            chat_id = update["message"]["chat"]["id"]
            text = update["message"].get("text", "").strip()
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
            if text.startswith("/start"):
                response = "üöÄ **SuperAi+ –£–ú–ù–´–ô –†–ï–ñ–ò–ú!**\n\nüíé _–¢–µ–ø–µ—Ä—å —è –ø–æ–Ω–∏–º–∞—é –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –¥–∞—é —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã_\nüéØ _–ê–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –ø–æ–¥ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã_\n‚ö° _–†–∞–±–æ—Ç–∞—é 24/7 –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫_\n\n**–ü—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ—Å–∏ –æ —á–µ–º —É–≥–æ–¥–Ω–æ!**"
            
            elif text.startswith("/help"):
                response = "ü§ñ **SuperAi+ –£–ú–ù–ê–Ø –ü–û–ú–û–©–¨**\n\nüîÆ **–ß—Ç–æ —è —É–º–µ—é:**\n‚Ä¢ –ü–æ–Ω–∏–º–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n‚Ä¢ –ü–æ–º–æ–≥–∞—Ç—å —Å —É—á–µ–±–æ–π –∏ –∑–∞–¥–∞—á–∞–º–∏\n‚Ä¢ –°–æ–∑–¥–∞–≤–∞—Ç—å –ø–ª–∞–Ω—ã –¥–µ–π—Å—Ç–≤–∏–π\n‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å\n‚Ä¢ –†–∞–±–æ—Ç–∞—Ç—å —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º\n\nüíé **–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å - –ø–æ–π–º—É –∏ –ø–æ–º–æ–≥—É!**"
            
            elif text.startswith("/status"):
                response = "üü¢ **–°–ò–°–¢–ï–ú–ê –£–ú–ù–´–• –û–¢–í–ï–¢–û–í:**\n\n‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ: –∞–∫—Ç–∏–≤–Ω–æ\n‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã: —Ä–∞–±–æ—Ç–∞—é—Ç\n‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å: 0.1-0.9—Å\n‚úÖ –ê–≤—Ç–æ-–ø–∏–Ω–≥: –∞–∫—Ç–∏–≤–µ–Ω\n\n‚ö° _–û—Ç–≤–µ—á–∞—é —Ç–æ—á–Ω–æ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã!_"
            
            else:
                # –£–ú–ù–ê–Ø –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ —É–ª—É—á—à–µ–Ω–Ω—ã–π AI
                response = SmartDeepSeekAI.get_smart_response(text, chat_id)
            
            await send_telegram_message(chat_id, response)
            
    except Exception as e:
        logger.error(f"Webhook error: {e}")
        if "message" in update:
            chat_id = update["message"]["chat"]["id"]
            await send_telegram_message(chat_id, "‚ö° **SuperAi+ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è...**\n\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥!")
    
    return {"status": "ok"}

async def send_telegram_message(chat_id, text):
    url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
    payload = {
        "chat_id": chat_id,
        "text": text,
        "parse_mode": "Markdown"
    }
    try:
        response = requests.post(url, json=payload, timeout=5)
        return response.json()
    except Exception as e:
        logger.error(f"Send message error: {e}")

@app.get("/")
async def root():
    return {"status": "SuperAi+ SMART MODE —Ä–∞–±–æ—Ç–∞–µ—Ç!"}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=10000, access_log=False)
